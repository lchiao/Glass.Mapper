


<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<!-- Mirrored from www.glass.lu/ by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 10 Jan 2019 10:13:45 GMT -->
<!-- Added by HTTrack -->

<!-- Mirrored from glass.lu/mapper/documentation/Upgrade-ToV5 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 24 May 2021 11:23:52 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">



    <link rel="stylesheet" href="../../content/plugins/bootstrap/css/bootstrap.min.css">
    <link rel="stylesheet" href="../../content/css/style.css">
    <link rel="stylesheet" href="../../content/plugins/font-awesome/css/font-awesome.min.css">
    <link rel="stylesheet" href="../../content/css/theme-colors/default.css">
    <link rel="stylesheet" href="../../content/plugins/sky-forms/version-2.0.1/css/custom-sky-forms.css">

    <link rel="stylesheet" href="../../content/plugins/parallax-slider/css/parallax-slider.css">

    <link rel="stylesheet" href="../../content/Site-Lessae52ae52.css?v=5" />
    <link rel="stylesheet" href="../../content/site.css">

    <title>Documentation - Glass</title>

    <link rel="shortcut icon" href="../../-/media/Images/Common/Horizon-Bordered-BlazeOrange-250.png">
    <!-- JS Global Compulsory -->
    <script type="text/javascript" src="../../content/plugins/jquery/jquery.min.js"></script>
    <script type="text/javascript" src="../../content/plugins/jquery/jquery-migrate.min.js"></script>
    <script type="text/javascript" src="../../content/plugins/bootstrap/js/bootstrap.min.js"></script>

    <script src="../../content/Site.js"></script>
    <script src="../google-code-prettify.googlecode.com/svn/loader/run_prettify.html"></script>
    <script type="text/javascript" src="../../content/plugins/parallax-slider/js/modernizr.js"></script>
    <script type="text/javascript" src="../../content/plugins/parallax-slider/js/jquery.cslider.js"></script>


</head>


<body class="metro  mvc ">

    <div class="wrapper">

        <div class="header header-sticky header-fixed-shrink">
            <div class="topbar">
            </div>

            <!-- Navbar -->
            <div class="navbar navbar-default mega-menu" role="navigation">
                <div class="container">
                    <!-- Brand and toggle get grouped for better mobile display -->
                    <div class="navbar-header">
                        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-responsive-collapse">
                            <span class="sr-only">Toggle navigation</span>
                            <span class="fa fa-bars"></span>
                        </button>
                        <a class="navbar-brand" href="../../index.html">

                            <img src="../../-/media/Images/Common/Horizon-Bordered-BlazeOrange-2503ca73ca7.png?h=50&amp;w=50&amp;la=en&amp;hash=C5F3C6D5FCB00EBE826D80BE26742A4D078D12D4" id="logo-header" alt="" />
                            <span style="vertical-align: middle;">Glass</span>

                        </a>
                    </div>

                    <!-- Collect the nav links, forms, and other content for toggling -->
                    <div class="collapse navbar-collapse navbar-responsive-collapse">
                        <ul class="nav navbar-nav">

                            <li class="">

                                <a href="../../Support.html">Support</a>
                            </li>
                            <li class="">

                                <a href="../../Training.html">Training</a>
                            </li>
                            <li class="">

                                <a href="../../Blog.html">Blog</a>
                            </li>
                            <li class="">

                                <a href="../../Mapper.html">Glass.Mapper.Sc</a>
                            </li>
                            <li class="">

                                <a href="../../Rockstars.html">Our Backers</a>
                            </li>
                            <li class="">

                                <a href="../../About.html">About</a>
                            </li>
                        </ul>
                    </div><!--/navbar-collapse-->
                </div>
            </div>
            <!-- End Navbar -->
        </div>

            <div class="breadcrumbs">
                <div class="container">
                    <h1 class="pull-left">

                        Documentation

                    </h1>

                </div><!--/container-->
            </div>

        


<div class="container content">
    <div class="row">
        <div class="col-md-3">


    <ul class="list-group sidebar-nav-v1" id="sidebar-nav">
        <li class="list-group-item list-toggle active">

            <a href="../../Mapper.html" class="collapsed">
                <i class="fa "></i>
                Glass.Mapper.Sc
            </a>
            <ul id="collapse-typography" class="sub-pages">
                <li>
                    <a href="../GettingStarted.html">
                        <i class="fa fa-chevron-circle-right"></i>
                        Getting Started

                    </a>
                </li>
                <li>
                    <a href="../../Training.html">
                        <i class="fa fa-chevron-circle-right"></i>
                        Training
                    </a>
                </li>
                <li>
                    <a href="../CompatibilityChart.html">
                        <i class="fa fa-chevron-circle-right"></i>
                        Download
                    </a>
                </li>
                <li>
                    <a href="../Contributing.html">
                        <i class="fa fa-chevron-circle-right"></i>
                        Contributing
                    </a>
                </li>
                <li>
                    <a href="../Community.html">
                        <i class="fa fa-chevron-circle-right"></i>
                        Community
                    </a>
                </li>
                <li>
                    <a href="../CompatibilityChart.html">
                        <i class="fa fa-chevron-circle-right"></i>
                        Compatibility Chart
                    </a>
                </li>
                <li>
                    <a href="../Releases.html">
                        <i class="fa fa-chevron-circle-right"></i>
                        Releases
                    </a>
                </li>
                <li>
                    <a href="../Documentation.html">
                        <i class="fa fa-chevron-circle-right"></i>
                        Documentation
                    </a>
                </li>
            </ul>
        </li>
    </ul>

    <div class="thumbnails thumbnail-style ">

        <img src="../../-/media/Images/Tiles/RDNS_Logo_WithText.png" style="width: 100%" class="img-responsive">

        <div class="caption">
            <hr style="margin: 5px 10px;">


            <h4>
                Glass.Mapper is supported by Refract DNS.
            </h4>
            <p>

            </p>
            <p>
                <a class="btn-u btn-u-sm" href="http://bit.ly/2RGdyRj">Find out more &gt; &gt;</a>
            </p>

        </div>
    </div>
</div>
        


<div class="col-md-9">
    <div class="row documentation">
        <h1 id="upgrading-to-v5">Upgrading To V5</h1>
<p>TThis page details the change and steps that you will need to take when upgrading to V5 and details the reason these changes were made.</p>
<h2 id="nuget-package-changes">Nuget Package Changes</h2>
<p>The first changei s the structure of the Nuget packages. In V4 there were only two nuget packages for all versions of Sitecore called Glass.Mapper.Sc and Glass.Mapper.Sc.Core,
when you installed this Nuget package a powershell script ran which would check the version of the Sitecore.Kernel.dll and the System.Web.Mvc.dll referenced by your project and automatically
reference the correct version of the Glass.Mapper.Sc DLLs.</p>
<p>In V5 we have had to remove the powershell script support because it is no longer supported in <a href="https://blog.nuget.org/20151008/NuGet-3-What-and-Why.html">Nuget v3</a>. Instead we now supply different Nuget packages based  on the version of Sitecore being used
(see the <a href="../CompatibilityChart.html">Compatibility Chart</a>. When you search for the Nuget packages you will see 4 different Nuget packages:</p>
<p><img src="../../Images/Docs/GMT-Nugets2125.png" alt="" /></p>
<p version="">The main Nuget is still Glass.Mapper.Sc., this contains all the configuration files required to initialise Glass.Mapper.Sc. The Nuget package Glass.Mapper.Sc.Core. should be referenced by all projects that use Glass.Mapper.Sc.</p>
<p>Due to the Nuget package name changes it is not a simple case of just using the Nuget update screen. You will need to uninstall Glass.Mapper.Sc V4 nuget packages and then install the V5 Nuget packages as required.</p>
<h2 id="recompile">Recompile</h2>
<p>All DLLs deployed to the same Sitecore instance must be compiled against V5. Therefore if you are using assemblies supplied by a third party that uses Glass.Mapper.Sc V5 you will need them to supply you new DLLs compiled against V5.</p>
<h2 id="lazy-loading">Lazy Loading</h2>
<p>Lazy load has changed in V5. In V4 it was necessary to decorate properties manually to turn lazy loading of, for example:</p>
<pre><code>public class Example{
  
   [SitecoreChildren(IsLazy = false)]
   public virtual IEnumerable&lt;Child&gt; Children{get;set;}

}
</code></pre>
<p>Lazy loading needs to be disabled on a model if it is going to be cached or for other business reasons. In V4 lazy loading had to be disabled on every property in the object graph manually and explicitly, this meant that in some locations on an object graph it would be missed. In large object graphs developers may not even know that they need to disable lazy loading on their model. It also meant that the same model could not be used for lazy and non-lazy scenarios.</p>
<p>In V5 we have decided to simplify this. Firstly the IsLazy setting has been removed from all all property configuration (both attribute and fluent configuration). This has now been replaced by configuring lazy loading when a model is requested from on of the Glass.Mapper.Sc services:</p>
<pre><code>var service = new SitecoreService(database.Database, context);
var target = service.GetItem&lt;stub1&gt;(&quot;/sitecore/content/parent/target&quot;,x=&gt;x.LazyDisabled());
</code></pre>
<p>This will disable lazy loading for all models in the object graph. This is an important change because it is likely that in V4 some models that should have had lazy loading disabled didn't and potentially hid large data loads or recursive models. When upgrading to V5 verify that your models will not load too much data.</p>
<p>Lazy loading will automatically be disabled if a request is marked a cachable.</p>
<h2 id="versioncountdisabler">VersionCountDisabler</h2>
<p>The VersionCountDisabled class has been removed. Version count can be disabled when requesting a model:</p>
<pre><code>var langItem1 = service.GetItem(path, x=&gt;x..VersionCountDisable());
</code></pre>
<p>This will disable the version count for all object in the graph. This change was made to make the intention of the developer clearer</p>
<p>The version count mechanism has also been moved to the Object Construction pipeline. This means that the version count can be completed disabled by removing the version count  task:</p>
<pre><code>dependencyResolver.ObjectConstructionFactory.Remove&lt;ItemVersionCountByRevisionTask&gt;();
</code></pre>
<p>The version check is now preformed by check the __Revision field instead of using item.Versions.Count. This check is must faster. If you prefer to use the old method replace the ItemVersionCountByRevisionTask task with the ItemVersionCountByRevisionTask task.</p>
<p>Custom Data Mappers and Pipeline Tasks
The structure of the of the mapping contexts passed between data-mapper and pipeline tasks have changed so that they make use of the new options classes. You will need to update your code accordingly.</p>
<h2 id="sitecorecontext">SitecoreContext</h2>
<p>The SitecoreContext class as been marked as obsolete. This class no longer worked with the architecture or direction of Sitecore and often caused confusion about when it should be created and destroyed. This service has been replaced by the following services:</p>
<ul>
<li>RequestContext</li>
<li>MvcContext</li>
<li>WebFormsContext</li>
</ul>
<p>These classes have a clean separation between representing the various HTTP requests being processed and the Sitecore Database being read.</p>
<h3 id="missing-methods">Missing Methods</h3>
<p>When migrating from SitecoreContext to one of the alternative Contexts you will notice that many of the original GetItem methods are now missing.</p>
<p>The <strong>GetCurrentItem</strong> method has been renamed to <strong>GetContentItem</strong>. This method was renamed because &quot;CurrentItem&quot; created confusion between the <strong>Sitecore.Context.Item</strong> and the
data source item.</p>
<pre><code>var item = sitecoreContext.GetCurrentItem&lt;MyModel&gt;();
</code></pre>
<p>becomes:</p>
<pre><code>var item = mvcContext.GetContextItem&lt;MyModel&gt;();
</code></pre>
<p>The majority of the other missing methods (for example GetItem, Query, etc) can now be accessed via the Sitecore service that is contained with the context object:</p>
<pre><code>var item = sitecoreContext.GetItem(&quot;/path&quot;);
</code></pre>
<p>becomes:</p>
<pre><code>var item = mvcContext.SitecoreService.GetItem(&quot;/path&quot;);
</code></pre>
<p>To make upgrading quicker you may want to create extension methods for each context which allows you to use the missing methods as before. You can then over a longer period of time update
them to use the SitecoreService.</p>
<p>So for example in our old V4 code we have the following:</p>
<pre><code>var sitecoreContext = new SitecoreContext();
var item = sitecoreContext.GetItem&lt;MyModel&gt;(&quot;/path&quot;);

</code></pre>
<p>We want to upgrade this code but still keep the GetItem method where it is. To do this we can extend the IRequestContext interface with an extension method:</p>
<pre><code>public static class IRequestContextExtensionMethods{

	public static T GetItem&lt;T&gt;(this IRequestContext context, string path) where T : class
	{	
		return context.SitecoreService.GetItem&lt;T&gt;(path);
	}

}

</code></pre>
<p>The old code can now bre update to the following:</p>
<pre><code>var mvcContext = new MvcContext();
var item = mvcContext.GetItem&lt;MyModel&gt;(&quot;/path&quot;);

</code></pre>
<p>If your old code infers type, for example:</p>
<pre><code>var sitecoreContext = new SitecoreContext();
var item = sitecoreContext.GetItem&lt;MyModel&gt;(&quot;/path&quot;, inferType: true);

</code></pre>
<p>Then update the extension method as follows:</p>
<pre><code>	using Glass.Mapper.Sc;

    public static class IRequestContextExtensionMethods
    {

        public static T GetItem&lt;T&gt;(this IRequestContext context, string path, bool inferType) where T : class

        {
            return context.SitecoreService.GetItem&lt;T&gt;(path, x =&gt; x.InferType(inferType));
        }

    }

</code></pre>
<h2 id="sitecore-service">Sitecore Service</h2>
<h3 id="map-method">Map Method</h3>
<p>The Map method has been renamed to Populate.</p>
<pre><code>var item = sitecoreService.Map&lt;MyModel&gt;();
</code></pre>
<p>becomes:</p>
<pre><code>var item = sitecoreService.Populate&lt;MyModel&gt;();
</code></pre>
<h3 id="sitecoreservice-method-parameters">SitecoreService Method Parameters</h3>
<p>All the SitecoreService methods have been reworked to use options classes instead of separate method parameters. Method parameters were causing us problem because every time we wanted to add an additional parameter we would need to create a huge number of overloads to cope with all the different possible permutations, for example the GetItem&lt;&gt; method has at lesat 30 different overrides!</p>
<p>We have therefore moved to options classes which allow you to configure all the settings for a model mapping on a single object and then pass that single object to the service. This settings object can then be easily passed through the different mapping processes to ensure that the original settings apply correctly everywhere.</p>
<p>For example inferring type used to be:</p>
<pre><code>sitecoreService.GetItem(&quot;/sitecore/Home&quot;, inferType:true);
</code></pre>
<p>This can now be changed to:</p>
<pre><code>service.GetItem(&quot;/sitecore/Home&quot;,x=&gt;x.InferType());
</code></pre>
<p>This change allows will allow us to add additional configuration options in the future without having to change the method signature for GetItem or the other methods. This will also make backward compatibility easier.</p>
<p>The V4 parameter methods are still available but they have been marked as obsolete.</p>
<h2 id="need-help-upgrading">Need help upgrading?</h2>
<p>If you need help upgrading your solution to V5 then please contact us. We can provide a range of consultancy services to help you upgrade and develop your Glass.Mapper.Sc and Sitecore solution.</p>
<p>Find out more on our Support page.</p>

    </div>

    <div class="row">
        <div class="row">
    <div class="devider devider-dashed margin-top-30 margin-bottom-30"></div>

    <div class="col-md-8">

        <div class="headline">
            <h3 class="">Become a Glass Mapper Expert</h3>
        </div>

        <p>
            The easiest way to become a Glass.Mapper.Sc <strong>EXPERT</strong> is by taking the V5 Training course!

        </p>
        <p>
            The training course contains 64+ lectures which take you from the basics of Glass.Mapper.Sc to advanced features like template enforcement, 
            type inferring and more.
        </p>

        <p class="text-center">
            <a href="../../Training.html" class="btn-u btn-u-lg" style="margin: 10px;">
                <em class=" fa fa-star icon-bg-darker"></em>
                Signup Up Today!
            </a>
        </p>

    </div>
    <div class="col-md-4 text-center">
        <img src="../../Images/V5Certified.png" style="max-height:200px"/>
    </div>
</div>

    </div>

</div>

    </div>
</div>

        <div class="footer-v1">
            <div class="footer">
                <div class="container">
                    <div class="row">
                        <!-- About -->
                        <div class="col-md-3 md-margin-bottom-40">
                            <div class="row text-center margin-bottom-10 margin-top-20">
                                <a href="../../index.html" class="">
                                    <img src="../../-/media/Images/Common/Horizon-Bordered-BlazeOrange-2503ca73ca7.png?h=50&amp;w=50&amp;la=en&amp;hash=C5F3C6D5FCB00EBE826D80BE26742A4D078D12D4" id="logo-header" alt="" />
                                </a>
                            </div>

                            <p>Glass is home to the #1 ORM for Sitecore. Glass.Mapper is the easiest way to map data from your Sitecore solution to your code.</p>
                        </div><!--/col-md-3-->
                        <!-- End About -->
                        <!-- Latest -->
                        <div class="col-md-3 md-margin-bottom-40">
                            <div class="headline">
                                <h2>Sponsored by</h2>
                            </div>
                            <a href="https://refractdns.com/">
                                <img src="../../-/media/Images/Tiles/RDNS_Logo_WithTextWhite.png" style="width: 100%" class="img-responsive">
                            </a>
                        </div><!--/col-md-3-->
                        <!-- End Latest -->
                        <!-- Link List -->
                        <div class="col-md-3 md-margin-bottom-40">
                            <div class="headline">
                                <h2>Useful Links</h2>
                            </div>
                            <ul class="list-unstyled link-list">
                                <li><a href="../../Blog.html">Blog</a><i class="fa fa-angle-right"></i></li>
                                <li><a href="../../Training.html">Training</a><i class="fa fa-angle-right"></i></li>
                                <li><a href="../../Mapper.html">Glass.Mapper.Sc</a><i class="fa fa-angle-right"></i></li>
                                <li><a href="../../Support.html">Support</a><i class="fa fa-angle-right"></i></li>
                            </ul>
                        </div><!--/col-md-3-->
                        <!-- End Link List -->
                        <!-- Address -->
                        <div class="col-md-3 map-img md-margin-bottom-40">
                            <div class="headline">
                                <h2>Contact Us</h2>
                            </div>
                            <address class="md-margin-bottom-40">
                                Twitter: <a class="element brand" href="http://twitter.com/@glasslu" target="_blank">@glasslu</a><br>
                                Email: <a class="element brand" href="mailto:hello@glass.lu">hello@glass.lu</a> <br />
                                M C Edwards Ltd trading as Glass<br />
                                Company No.:08641300 <br />
                            </address>
                        </div><!--/col-md-3-->
                        <!-- End Address -->
                    </div>
                </div>

            </div><!--/footer-->
        </div>
        <!-- 1/10/2019 8:47:53 AM -->
        <script>
            (function (i, s, o, g, r, a, m) {
                i['GoogleAnalyticsObject'] = r; i[r] = i[r] || function () {
                    (i[r].q = i[r].q || []).push(arguments)
                }, i[r].l = 1 * new Date(); a = s.createElement(o),
                    m = s.getElementsByTagName(o)[0]; a.async = 1; a.src = g; m.parentNode.insertBefore(a, m)
            })(window, document, 'script', '../www.google-analytics.com/analytics.html', 'ga');

            ga('create', 'UA-55731850-1', 'auto');
            ga('send', 'pageview');

        </script>


        <div class="footer-v1">

            <div class="copyright">
                <div class="container">
                    <div class="row">
                        <div class="col-md-3">
                            <p>
                                2019 &copy; All Rights Reserved.
                            </p>
                        </div>
                        <div class="col-md-9">

                            <p>
                                <a href="../../-/media/Files/Privacy_Policy_and_Cookie_Policy_Europe.pdf">Privacy Policy</a> | <a href="../../-/media/Files/Website_TCs_Template.pdf">Terms and Conditions</a>
                            </p>
                        </div>
                    </div>
                </div>
            </div><!--/copyright-->
        </div>

        <div class="hidden" id="perfResults">
            <li class="topbar-devider"></li>
            <li>
                <i class="fa fa-clock-o" title="Page Render Time"></i> 30
            </li>
            <li>
                <img src="content/icon-bbbbbb-16.html" title="Glass Time" style="width: 8px;"> 3
            </li>
            <li>
                <i class="fa fa-pencil-square-o" title="Glass items requested"></i> 13
            </li>
            <li>
                <i class="fa fa-cloud" title="Glass items from cache"></i> 10
            </li>
        </div>
        <script>
            (function ($) {

                $(function () {
                    var results = $("#perfResults");
                    var placeholder = $("#resultsReplaces");

                    var html = results.html();
                    placeholder.replaceWith(html);
                });
            })(jQuery);
        </script>




    </div>
</body>


<!-- Mirrored from glass.lu/mapper/documentation/Upgrade-ToV5 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 24 May 2021 11:23:54 GMT -->
</html>