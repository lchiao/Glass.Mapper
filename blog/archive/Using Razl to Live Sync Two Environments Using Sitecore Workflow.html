


<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<!-- Mirrored from www.glass.lu/ by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 10 Jan 2019 10:13:45 GMT -->
<!-- Added by HTTrack -->

<!-- Mirrored from glass.lu/blog/archive/Using Razl to Live Sync Two Environments Using Sitecore Workflow by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 24 May 2021 11:23:55 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">



    <link rel="stylesheet" href="../../content/plugins/bootstrap/css/bootstrap.min.css">
    <link rel="stylesheet" href="../../content/css/style.css">
    <link rel="stylesheet" href="../../content/plugins/font-awesome/css/font-awesome.min.css">
    <link rel="stylesheet" href="../../content/css/theme-colors/default.css">
    <link rel="stylesheet" href="../../content/plugins/sky-forms/version-2.0.1/css/custom-sky-forms.css">

    <link rel="stylesheet" href="../../content/plugins/parallax-slider/css/parallax-slider.css">

    <link rel="stylesheet" href="../../content/Site-Lessae52ae52.css?v=5" />
    <link rel="stylesheet" href="../../content/site.css">

    <title>Using Razl to Live Sync Two Environments Using Sitecore Workflow - Glass</title>

    <link rel="shortcut icon" href="../../-/media/Images/Common/Horizon-Bordered-BlazeOrange-250.png">
    <!-- JS Global Compulsory -->
    <script type="text/javascript" src="../../content/plugins/jquery/jquery.min.js"></script>
    <script type="text/javascript" src="../../content/plugins/jquery/jquery-migrate.min.js"></script>
    <script type="text/javascript" src="../../content/plugins/bootstrap/js/bootstrap.min.js"></script>

    <script src="../../content/Site.js"></script>
    <script src="//google-code-prettify.googlecode.com/svn/loader/run_prettify.js"></script>
    <script type="text/javascript" src="../../content/plugins/parallax-slider/js/modernizr.js"></script>
    <script type="text/javascript" src="../../content/plugins/parallax-slider/js/jquery.cslider.js"></script>


</head>


<body class="metro  mvc ">

    <div class="wrapper">

        <div class="header header-sticky header-fixed-shrink">
            <div class="topbar">
            </div>

            <!-- Navbar -->
            <div class="navbar navbar-default mega-menu" role="navigation">
                <div class="container">
                    <!-- Brand and toggle get grouped for better mobile display -->
                    <div class="navbar-header">
                        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-responsive-collapse">
                            <span class="sr-only">Toggle navigation</span>
                            <span class="fa fa-bars"></span>
                        </button>
                        <a class="navbar-brand" href="../../index.html">

                            <img src="../../-/media/Images/Common/Horizon-Bordered-BlazeOrange-2503ca73ca7.png?h=50&amp;w=50&amp;la=en&amp;hash=C5F3C6D5FCB00EBE826D80BE26742A4D078D12D4" id="logo-header" alt="" />
                            <span style="vertical-align: middle;">Glass</span>

                        </a>
                    </div>

                    <!-- Collect the nav links, forms, and other content for toggling -->
                    <div class="collapse navbar-collapse navbar-responsive-collapse">
                        <ul class="nav navbar-nav">

                            <li class="">

                                <a href="../../Support.html">Support</a>
                            </li>
                            <li class="">

                                <a href="../../Training.html">Training</a>
                            </li>
                            <li class="">

                                <a href="../../Blog.html">Blog</a>
                            </li>
                            <li class="">

                                <a href="../../Mapper.html">Glass.Mapper.Sc</a>
                            </li>
                            <li class="">

                                <a href="../../Rockstars.html">Our Backers</a>
                            </li>
                            <li class="">

                                <a href="../../About.html">About</a>
                            </li>
                        </ul>
                    </div><!--/navbar-collapse-->
                </div>
            </div>
            <!-- End Navbar -->
        </div>

            <div class="breadcrumbs">
                <div class="container">
                    <h1 class="pull-left">

                        Using Razl to Live Sync Two Environments Using Sitecore Workflow

                    </h1>

                </div><!--/container-->
            </div>

        


<div class="container content">
    <div class="row">
        
 

        
<div>
    
</div>
<div class="row">
    <div class="col-md-12">

        <div class="blog margin-bottom-40">
            <div class="blog-post-tags">
                <ul class="list-unstyled list-inline blog-info pull-right">
                    <li>
                        <h3>
                            <i class="fa fa-calendar"></i>
                            15 May 2014
                        </h3>
                    </li>

                        <li>
                            <h3>
                                <a href="../../About/Mike.html">
                                    <i class="fa fa-pencil"></i>
                                    Mike
                                </a>
                            </h3>
                        </li>
                </ul>
            </div>
        </div>
    </div>
</div>

            <img src="../../-/media/Images/Blogs/Archive/RazlPublish633a633a.png?h=51&amp;w=200&amp;la=en&amp;hash=7D7124C88D716CFE1578E201EB8E1DADD5D005E4" class="pull-right img-responsive img-bordered margin-bottom-10 margin-left-10" alt="">
    




<p class='lead'>This post has been migrated from <strong>www.experimentsincode.com</strong>, we apologise if some of the images or content is missing</p>Today I received an email from Mike and Pekto about the possibility of using Razl to move an item from one Sitecore environment (staging) to another Sitecore environment (live) as the item goes through workflow, the challenge was set, so time to see if it is possible.

Three things I knew I was going to need to solve this problem:
<ol>
	<li><a href="http://razl.net/">Razl</a></li>
	<li>A custom Sitecore workflow action.</li>
	<li>A custom script.</li>
</ol>

Number 1 was easy, I just installed a new version of Razl on the staging server since this is where the copy will be kicked off from.

Number 2 was going to be more complex so I decided I would tackle number 3 next. Since the script would be copying from staging to live and the only variable is the item to copy I knew I would need a single placeholder for the item ID and everything else can have fixed values:

<pre class="xml">
&lt;razl&gt;
	&lt;connection name="Live" readOnly ="false" install="false"&gt;
		&lt;url&gt;http://live.demo.tds/&lt;/url&gt;
		&lt;accessGuid&gt;757cb84a-04c3-4bac-a95e-d05b7b05eb11&lt;/accessGuid&gt;
		&lt;database&gt;master&lt;/database&gt;
	&lt;/connection&gt;
	&lt;connection name="Staging" readOnly ="false" install="false"&gt;
		&lt;url&gt;http://staging.demo.tds/&lt;/url&gt;
		&lt;accessGuid&gt;757cb84a-04c3-4bac-a95e-d05b7b05eb11&lt;/accessGuid&gt;
		&lt;database&gt;master&lt;/database&gt;		
	&lt;/connection&gt;
	&lt;operation name="CopyItem" source="Staging" target="Live"&gt;
		&lt;parameter name="itemId"&gt;$(itemId)&lt;/parameter&gt;
		&lt;parameter name="overwrite"&gt;true&lt;/parameter&gt;
	&lt;/operation&gt;
&lt;/razl&gt;
</pre>

My script makes use of the <strong>CopyItem</strong> command and has the $(itemId) placeholder, this will copy just the item specified by the ID. The script also assumes that the Razl service is already installed on both environments, I recommend you do this because you don't want the script always installing the connector.

Ok that bit was simple next to tackle number 2 the workflow action, all I need to do is make my workflow action call Razl and pass it the ID of the item I want to copy:

                           <pre class="csharp">
    public class RazlPublish
    {
        public const string RazlPath = @"C:\Program Files (x86)\Hedgehog Development\Razl\Razl.exe";
        
        public void Process(WorkflowPipelineArgs args)
        {
            Item dataItem = args.DataItem;
            Item innerItem = args.ProcessorItem.InnerItem;

            string script = WebUtil.ParseUrlParameters(innerItem["parameters"])["script"];
            string fullScript = HttpContext.Current.Server.MapPath(script);

            string parameters = string.Format("itemId={0};templateId={1};parentId={2}", dataItem.ID, dataItem.TemplateID, dataItem.ParentID);
            
            ProcessStartInfo startInfo = new ProcessStartInfo();
            startInfo.CreateNoWindow = false;
            startInfo.UseShellExecute = false;
            startInfo.FileName = RazlPath;
            startInfo.WindowStyle = ProcessWindowStyle.Hidden;
            startInfo.Arguments = string.Format("/script:{0} /p:{1}", fullScript, parameters);

            startInfo.RedirectStandardOutput = true;
            startInfo.RedirectStandardError = true;

            Sitecore.Diagnostics.Log.Info(string.Format("Razl Script Started {0} {1}", startInfo.FileName, startInfo.Arguments), this);

            string info = string.Empty;
            string error = string.Empty;
            StringBuilder data = new StringBuilder();

            using (Process exeProcess = System.Diagnostics.Process.Start(startInfo))
            {
                info = exeProcess.StandardOutput.ReadToEnd();
                error = exeProcess.StandardError.ReadToEnd();

                exeProcess.OutputDataReceived += (sender, args1) =&gt; data.AppendLine(args1.Data);
                exeProcess.WaitForExit();
            }

            if (!string.IsNullOrEmpty(info))
            {
                Sitecore.Diagnostics.Log.Info(info, this);
            }
            if (!string.IsNullOrEmpty(error))
            {
                Sitecore.Diagnostics.Log.Error(error, this);
            }

            if (!string.IsNullOrEmpty(data.ToString()))
            {
                Sitecore.Diagnostics.Log.Info(data.ToString(), this);
            }


            Sitecore.Diagnostics.Log.Info(string.Format("Razl Script Finished {0} {1}", startInfo.FileName, startInfo.Arguments), this);
        }
    }
</pre>

A few key points about this workflow action, firstly notice that I am going to pull the script I want to run from a parameter on the workflow action item:

<pre class="csharp">
            string script = WebUtil.ParseUrlParameters(innerItem["parameters"])["script"];
            string fullScript = HttpContext.Current.Server.MapPath(script);
</pre>

Secondly I pass a load of parameters into Razl, this is to give a little bit of future proofing:

<pre class="csharp">
           string parameters = string.Format("itemId={0};templateId={1};parentId={2}", dataItem.ID, dataItem.TemplateID, dataItem.ParentID);
</pre>

Finally I need to create my action item in Sitecore:

<a href="../../www.experimentsincode.com/wp-content/uploads/2014/05/RazlPublish.html"><img src="../../-/media/Images/Blogs/Archive/RazlPublish21252125.png?la=en" alt="" title="RazlPublish" width="711" height="182" class="alignnone size-full wp-image-669"></a>

With everything in place I can now push items through workflow on staging and then have them automatically replicated to Live without any manual interaction!

This process could easily be modified to work with events such as item saved or item created if you didn't want to use a workflow action.








    

    </div>
</div>

        <div class="footer-v1">
            <div class="footer">
                <div class="container">
                    <div class="row">
                        <!-- About -->
                        <div class="col-md-3 md-margin-bottom-40">
                            <div class="row text-center margin-bottom-10 margin-top-20">
                                <a href="../../index.html" class="">
                                    <img src="../../-/media/Images/Common/Horizon-Bordered-BlazeOrange-2503ca73ca7.png?h=50&amp;w=50&amp;la=en&amp;hash=C5F3C6D5FCB00EBE826D80BE26742A4D078D12D4" id="logo-header" alt="" />
                                </a>
                            </div>

                            <p>Glass is home to the #1 ORM for Sitecore. Glass.Mapper is the easiest way to map data from your Sitecore solution to your code.</p>
                        </div><!--/col-md-3-->
                        <!-- End About -->
                        <!-- Latest -->
                        <div class="col-md-3 md-margin-bottom-40">
                            <div class="headline">
                                <h2>Sponsored by</h2>
                            </div>
                            <a href="https://refractdns.com/">
                                <img src="../../-/media/Images/Tiles/RDNS_Logo_WithTextWhite.png" style="width: 100%" class="img-responsive">
                            </a>
                        </div><!--/col-md-3-->
                        <!-- End Latest -->
                        <!-- Link List -->
                        <div class="col-md-3 md-margin-bottom-40">
                            <div class="headline">
                                <h2>Useful Links</h2>
                            </div>
                            <ul class="list-unstyled link-list">
                                <li><a href="../../Blog.html">Blog</a><i class="fa fa-angle-right"></i></li>
                                <li><a href="../../Training.html">Training</a><i class="fa fa-angle-right"></i></li>
                                <li><a href="../../Mapper.html">Glass.Mapper.Sc</a><i class="fa fa-angle-right"></i></li>
                                <li><a href="../../Support.html">Support</a><i class="fa fa-angle-right"></i></li>
                            </ul>
                        </div><!--/col-md-3-->
                        <!-- End Link List -->
                        <!-- Address -->
                        <div class="col-md-3 map-img md-margin-bottom-40">
                            <div class="headline">
                                <h2>Contact Us</h2>
                            </div>
                            <address class="md-margin-bottom-40">
                                Twitter: <a class="element brand" href="http://twitter.com/@glasslu" target="_blank">@glasslu</a><br>
                                Email: <a class="element brand" href="mailto:hello@glass.lu">hello@glass.lu</a> <br />
                                M C Edwards Ltd trading as Glass<br />
                                Company No.:08641300 <br />
                            </address>
                        </div><!--/col-md-3-->
                        <!-- End Address -->
                    </div>
                </div>

            </div><!--/footer-->
        </div>
        <!-- 1/10/2019 8:47:53 AM -->
        <script>
            (function (i, s, o, g, r, a, m) {
                i['GoogleAnalyticsObject'] = r; i[r] = i[r] || function () {
                    (i[r].q = i[r].q || []).push(arguments)
                }, i[r].l = 1 * new Date(); a = s.createElement(o),
                    m = s.getElementsByTagName(o)[0]; a.async = 1; a.src = g; m.parentNode.insertBefore(a, m)
            })(window, document, 'script', '../www.google-analytics.com/analytics.html', 'ga');

            ga('create', 'UA-55731850-1', 'auto');
            ga('send', 'pageview');

        </script>


        <div class="footer-v1">

            <div class="copyright">
                <div class="container">
                    <div class="row">
                        <div class="col-md-3">
                            <p>
                                2019 &copy; All Rights Reserved.
                            </p>
                        </div>
                        <div class="col-md-9">

                            <p>
                                <a href="../../-/media/Files/Privacy_Policy_and_Cookie_Policy_Europe.pdf">Privacy Policy</a> | <a href="../../-/media/Files/Website_TCs_Template.pdf">Terms and Conditions</a>
                            </p>
                        </div>
                    </div>
                </div>
            </div><!--/copyright-->
        </div>

        <div class="hidden" id="perfResults">
            <li class="topbar-devider"></li>
            <li>
                <i class="fa fa-clock-o" title="Page Render Time"></i> 30
            </li>
            <li>
                <img src="content/icon-bbbbbb-16.html" title="Glass Time" style="width: 8px;"> 3
            </li>
            <li>
                <i class="fa fa-pencil-square-o" title="Glass items requested"></i> 13
            </li>
            <li>
                <i class="fa fa-cloud" title="Glass items from cache"></i> 10
            </li>
        </div>
        <script>
            (function ($) {

                $(function () {
                    var results = $("#perfResults");
                    var placeholder = $("#resultsReplaces");

                    var html = results.html();
                    placeholder.replaceWith(html);
                });
            })(jQuery);
        </script>




    </div>
</body>


<!-- Mirrored from glass.lu/blog/archive/Using Razl to Live Sync Two Environments Using Sitecore Workflow by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 24 May 2021 11:23:57 GMT -->
</html>