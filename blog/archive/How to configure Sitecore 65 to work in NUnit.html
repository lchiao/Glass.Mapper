


<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<!-- Mirrored from www.glass.lu/ by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 10 Jan 2019 10:13:45 GMT -->
<!-- Added by HTTrack -->

<!-- Mirrored from glass.lu/blog/archive/How to configure Sitecore 65 to work in NUnit by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 24 May 2021 11:25:25 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">



    <link rel="stylesheet" href="../../content/plugins/bootstrap/css/bootstrap.min.css">
    <link rel="stylesheet" href="../../content/css/style.css">
    <link rel="stylesheet" href="../../content/plugins/font-awesome/css/font-awesome.min.css">
    <link rel="stylesheet" href="../../content/css/theme-colors/default.css">
    <link rel="stylesheet" href="../../content/plugins/sky-forms/version-2.0.1/css/custom-sky-forms.css">

    <link rel="stylesheet" href="../../content/plugins/parallax-slider/css/parallax-slider.css">

    <link rel="stylesheet" href="../../content/Site-Lessae52ae52.css?v=5" />
    <link rel="stylesheet" href="../../content/site.css">

    <title>How to configure Sitecore 6.5 to work in NUnit - Glass</title>

    <link rel="shortcut icon" href="../../-/media/Images/Common/Horizon-Bordered-BlazeOrange-250.png">
    <!-- JS Global Compulsory -->
    <script type="text/javascript" src="../../content/plugins/jquery/jquery.min.js"></script>
    <script type="text/javascript" src="../../content/plugins/jquery/jquery-migrate.min.js"></script>
    <script type="text/javascript" src="../../content/plugins/bootstrap/js/bootstrap.min.js"></script>

    <script src="../../content/Site.js"></script>
    <script src="../google-code-prettify.googlecode.com/svn/loader/run_prettify.html"></script>
    <script type="text/javascript" src="../../content/plugins/parallax-slider/js/modernizr.js"></script>
    <script type="text/javascript" src="../../content/plugins/parallax-slider/js/jquery.cslider.js"></script>


</head>


<body class="metro  mvc ">

    <div class="wrapper">

        <div class="header header-sticky header-fixed-shrink">
            <div class="topbar">
            </div>

            <!-- Navbar -->
            <div class="navbar navbar-default mega-menu" role="navigation">
                <div class="container">
                    <!-- Brand and toggle get grouped for better mobile display -->
                    <div class="navbar-header">
                        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-responsive-collapse">
                            <span class="sr-only">Toggle navigation</span>
                            <span class="fa fa-bars"></span>
                        </button>
                        <a class="navbar-brand" href="../../index.html">

                            <img src="../../-/media/Images/Common/Horizon-Bordered-BlazeOrange-2503ca73ca7.png?h=50&amp;w=50&amp;la=en&amp;hash=C5F3C6D5FCB00EBE826D80BE26742A4D078D12D4" id="logo-header" alt="" />
                            <span style="vertical-align: middle;">Glass</span>

                        </a>
                    </div>

                    <!-- Collect the nav links, forms, and other content for toggling -->
                    <div class="collapse navbar-collapse navbar-responsive-collapse">
                        <ul class="nav navbar-nav">

                            <li class="">

                                <a href="../../Support.html">Support</a>
                            </li>
                            <li class="">

                                <a href="../../Training.html">Training</a>
                            </li>
                            <li class="">

                                <a href="../../Blog.html">Blog</a>
                            </li>
                            <li class="">

                                <a href="../../Mapper.html">Glass.Mapper.Sc</a>
                            </li>
                            <li class="">

                                <a href="../../Rockstars.html">Our Backers</a>
                            </li>
                            <li class="">

                                <a href="../../About.html">About</a>
                            </li>
                        </ul>
                    </div><!--/navbar-collapse-->
                </div>
            </div>
            <!-- End Navbar -->
        </div>

            <div class="breadcrumbs">
                <div class="container">
                    <h1 class="pull-left">

                        How to configure Sitecore 6.5 to work in NUnit

                    </h1>

                </div><!--/container-->
            </div>

        


<div class="container content">
    <div class="row">
        
 

        
<div>
    
</div>
<div class="row">
    <div class="col-md-12">

        <div class="blog margin-bottom-40">
            <div class="blog-post-tags">
                <ul class="list-unstyled list-inline blog-info pull-right">
                    <li>
                        <h3>
                            <i class="fa fa-calendar"></i>
                            18 Jun 2011
                        </h3>
                    </li>

                        <li>
                            <h3>
                                <a href="../../About/Mike.html">
                                    <i class="fa fa-pencil"></i>
                                    Mike
                                </a>
                            </h3>
                        </li>
                </ul>
            </div>
        </div>
    </div>
</div>

            <img src="../../-/media/Images/Blogs/Archive/TestAssemblya6dfa6df.jpg?h=148&amp;w=200&amp;la=en&amp;hash=5A0BCCE8A21A6F896551C20259E30340618C0958" class="pull-right img-responsive img-bordered margin-bottom-10 margin-left-10" alt="">
    




<p class='lead'>This post has been migrated from <strong>www.experimentsincode.com</strong>, we apologise if some of the images or content is missing</p>The post describes the steps you will need to take to get Sitecore 6.5 running in the NUnit GUI. This will allow you to run unit tests in the NUnit GUI that pull data from Sitecore. I will be using the test assembly from the <a href="../../index-2.html">Glass.Sitecore.Mapper</a> project as the example.

First we have our project with the test assembly:

<a href="../../s400290293.websitehome.co.uk/wp-content/uploads/2011/06/TestAssembly.html"><img class="alignnone size-full wp-image-344" title="TestAssembly" src="../../-/media/Images/Blogs/Archive/TestAssembly21252125.jpg?la=en" alt="" width="239" height="177"></a>

<div style="clear:both"></div>

In the test assembly create an App.Config:

<a href="../../s400290293.websitehome.co.uk/wp-content/uploads/2011/06/Appconfig.html"><img class="alignnone size-full wp-image-345" title="Appconfig" src="../../-/media/Images/Blogs/Archive/Appconfig21252125.jpg?la=en" alt="" width="214" height="197"></a>

<div style="clear:both"></div>

Copy the contents of the App_Config directory in your website to the App_Config directory in your test assembly:

<a href="../../s400290293.websitehome.co.uk/wp-content/uploads/2011/06/AppConfigDir.html"><img class="alignnone size-full wp-image-346" title="AppConfigDir" src="../../-/media/Images/Blogs/Archive/AppConfigDir21252125.jpg?la=en" alt="" width="234" height="617"></a>

<div style="clear:both"></div>
Notice that in my App_Config directory I also have a Sitecore.Config file, this contains the contents of the /configuration/sitecore node that normally lives in the Web.Config. I like to separate out the Sitecore section from the main web.config because it is such a large piece of config.

Open the Ã‚Â App.Config file in your test assembly and add the following configuration sections to /configuration/configsections:
<pre class="brush:xml">    &lt;section name="log4net" type="log4net.Config.Log4NetConfigurationSectionHandler, Sitecore.Logging" /&gt;
    &lt;section name="sitecore" type="Sitecore.Configuration.ConfigReader, Sitecore.Kernel" /&gt;</pre>
Beneath the /configuration element add:
<pre class="brush:xml">   &lt;sitecore configSource="App_Config\Sitecore.config" /&gt;
   &lt;log4net /&gt;</pre>
Your App.Config should look something like this:

<a href="../../s400290293.websitehome.co.uk/wp-content/uploads/2011/06/AppConfigContents.html"><img class="alignnone size-full wp-image-351" title="AppConfigContents" src="../../-/media/Images/Blogs/Archive/AppConfigContents21252125.jpg?la=en" alt="" width="751" height="209"></a>

Now open the file /App_Config/Sitecore.config, this should contain the main Sitecore config, you will now need to go through the config to change all paths to the files that are included, the changes are detailed below:
<table>
<tbody>
<tr>
<th>Line</th>
<th>Original</th>
<th>New</th>
</tr>
<tr>
<td>7</td>
<td>&lt;sc.include file="/App_Config/Prototypes.config" /&gt;</td>
<td>&lt;sc.include file=".\App_Config\Prototypes.config" /&gt;</td>
</tr>
<tr>
<td>665</td>
<td>&lt;sc.include file="/App_Config/Prefetch/Common.config" /&gt;

&lt;sc.include file="/App_Config/Prefetch/Core.config" /&gt;</td>
<td>&lt;sc.include file=".\App_Config\Prefetch\Common.config" /&gt;

&lt;sc.include file=".\App_Config\Prefetch\Core.config" /&gt;</td>
</tr>
<tr>
<td>703</td>
<td>&lt;sc.include file="/App_Config/Prefetch/Common.config" /&gt;

&lt;sc.include file="/App_Config/Prefetch/Master.config" /&gt;</td>
<td>&lt;sc.include file=".\App_Config\Prefetch\Common.config" /&gt;

&lt;sc.include file=".\App_Config\Prefetch\Master.config" /&gt;</td>
</tr>
<tr>
<td>748</td>
<td>&lt;sc.include file="/App_Config/Prefetch/Common.config" /&gt;

&lt;sc.include file="/App_Config/Prefetch/Web.config" /&gt;</td>
<td>&lt;sc.include file=".\App_Config\Prefetch\Common.config" /&gt;

&lt;sc.include file=".\App_Config\Prefetch\Web.config" /&gt;</td>
</tr>
<tr>
<td>997</td>
<td>&lt;add name="domains" type="Sitecore.Configuration.XmlConfigStore, Sitecore.Kernel"

factoryMethod="LoadFromFile" arg0="/App_Config/Security/Domains.config" /&gt;

&lt;add name="globalRoles" type="Sitecore.Configuration.XmlConfigStore, Sitecore.Kernel"

factoryMethod="LoadFromFile" arg0="/App_Config/Security/GlobalRoles.config" /&gt;</td>
<td>&lt;add name="domains" type="Sitecore.Configuration.XmlConfigStore, Sitecore.Kernel"

factoryMethod="LoadFromFile" arg0=".\App_Config\Security\Domains.config" /&gt;

&lt;add name="globalRoles" type="Sitecore.Configuration.XmlConfigStore, Sitecore.Kernel"

factoryMethod="LoadFromFile" arg0=".\App_Config\Security\GlobalRoles.config" /&gt;</td>
</tr>
<tr>
<td>1083</td>
<td>&lt;sc.include file="/App_Config/FieldTypes.config" /&gt;</td>
<td>&lt;sc.include file=".\App_Config\FieldTypes.config" /&gt;</td>
</tr>
<tr>
<td>1517</td>
<td>&lt;sc.include file="/App_Config/XamlSharp.config" /&gt;</td>
<td>&lt;sc.include file=".\App_Config\XamlSharp.config" /&gt;</td>
</tr>
<tr>
<td>1521</td>
<td>&lt;sc.include file="/App_Config/LanguageDefinitions.config" /&gt;</td>
<td>&lt;sc.include file=".\App_Config\LanguageDefinitions.config" /&gt;</td>
</tr>
<tr>
<td>1808</td>
<td>&lt;sc.include file="/App_Config/MimeTypes.config" /&gt;</td>
<td>&lt;sc.include file=".\App_Config\MimeTypes.config" /&gt;</td>
</tr>
<tr>
<td>1834</td>
<td>&lt;sc.include file="/App_Config/Commands.config" /&gt;</td>
<td>&lt;sc.include file=".\App_Config\Commands.config" /&gt;</td>
</tr>
<tr>
<td>1838</td>
<td>&lt;sc.include file="/App_Config/Icons.config" /&gt;</td>
<td>&lt;sc.include file=".\App_Config\Icons.config" /&gt;</td>
</tr>
<tr>
<td>1842</td>
<td>&lt;sc.include file="/App_Config/Portraits.config" /&gt;</td>
<td>&lt;sc.include file=".\App_Config\Portraits.config" /&gt;</td>
</tr>
</tbody>
</table>
You will also need to change the path to your license file to the full path:
<pre class="brush:xml">    &lt;setting name="LicenseFile" value="D:\projects\Glass\Sitecore\Data\license.xml" /&gt;</pre>
Finally for every file beneath the App_Config in your test assembly you need to ensure that it is copied on build:

<a href="../../s400290293.websitehome.co.uk/wp-content/uploads/2011/06/copyalways.html"><img class="alignnone size-full wp-image-349" title="copyalways" src="../../-/media/Images/Blogs/Archive/copyalways21252125.jpg?la=en" alt="" width="335" height="233"></a>
<div style="clear:both"></div>
Your test assembly will need to reference the following Sitecore assemblies:
<ul>
	<li>Sitecore.Kernal.dll</li>
	<li>Sitecore.Logging.dll</li>
	<li>Sitecore.Nexus.dll</li>
</ul>
Finally to test that you have configured the test assembly correctly you can create a simple test to pull some data from Sitecore:
<pre class="brush:csharp">    [TestFixture]
    public class SitecoreConnectionFixture
    {
        [Test]
        public void ConnectionTest_ConnectsToSitecoreDatabase_RetrievesRootItem()
        {
            Database db = global::Sitecore.Configuration.Factory.GetDatabase("master");
            Item item = db.GetItem("/sitecore");
            Assert.IsNotNull(item);
            Assert.AreEqual("sitecore", item.Name.ToLower());

        }
    }</pre>

    

    </div>
</div>

        <div class="footer-v1">
            <div class="footer">
                <div class="container">
                    <div class="row">
                        <!-- About -->
                        <div class="col-md-3 md-margin-bottom-40">
                            <div class="row text-center margin-bottom-10 margin-top-20">
                                <a href="../../index.html" class="">
                                    <img src="../../-/media/Images/Common/Horizon-Bordered-BlazeOrange-2503ca73ca7.png?h=50&amp;w=50&amp;la=en&amp;hash=C5F3C6D5FCB00EBE826D80BE26742A4D078D12D4" id="logo-header" alt="" />
                                </a>
                            </div>

                            <p>Glass is home to the #1 ORM for Sitecore. Glass.Mapper is the easiest way to map data from your Sitecore solution to your code.</p>
                        </div><!--/col-md-3-->
                        <!-- End About -->
                        <!-- Latest -->
                        <div class="col-md-3 md-margin-bottom-40">
                            <div class="headline">
                                <h2>Sponsored by</h2>
                            </div>
                            <a href="https://refractdns.com/">
                                <img src="../../-/media/Images/Tiles/RDNS_Logo_WithTextWhite.png" style="width: 100%" class="img-responsive">
                            </a>
                        </div><!--/col-md-3-->
                        <!-- End Latest -->
                        <!-- Link List -->
                        <div class="col-md-3 md-margin-bottom-40">
                            <div class="headline">
                                <h2>Useful Links</h2>
                            </div>
                            <ul class="list-unstyled link-list">
                                <li><a href="../../Blog.html">Blog</a><i class="fa fa-angle-right"></i></li>
                                <li><a href="../../Training.html">Training</a><i class="fa fa-angle-right"></i></li>
                                <li><a href="../../Mapper.html">Glass.Mapper.Sc</a><i class="fa fa-angle-right"></i></li>
                                <li><a href="../../Support.html">Support</a><i class="fa fa-angle-right"></i></li>
                            </ul>
                        </div><!--/col-md-3-->
                        <!-- End Link List -->
                        <!-- Address -->
                        <div class="col-md-3 map-img md-margin-bottom-40">
                            <div class="headline">
                                <h2>Contact Us</h2>
                            </div>
                            <address class="md-margin-bottom-40">
                                Twitter: <a class="element brand" href="http://twitter.com/@glasslu" target="_blank">@glasslu</a><br>
                                Email: <a class="element brand" href="mailto:hello@glass.lu">hello@glass.lu</a> <br />
                                M C Edwards Ltd trading as Glass<br />
                                Company No.:08641300 <br />
                            </address>
                        </div><!--/col-md-3-->
                        <!-- End Address -->
                    </div>
                </div>

            </div><!--/footer-->
        </div>
        <!-- 1/10/2019 8:47:53 AM -->
        <script>
            (function (i, s, o, g, r, a, m) {
                i['GoogleAnalyticsObject'] = r; i[r] = i[r] || function () {
                    (i[r].q = i[r].q || []).push(arguments)
                }, i[r].l = 1 * new Date(); a = s.createElement(o),
                    m = s.getElementsByTagName(o)[0]; a.async = 1; a.src = g; m.parentNode.insertBefore(a, m)
            })(window, document, 'script', '../www.google-analytics.com/analytics.html', 'ga');

            ga('create', 'UA-55731850-1', 'auto');
            ga('send', 'pageview');

        </script>


        <div class="footer-v1">

            <div class="copyright">
                <div class="container">
                    <div class="row">
                        <div class="col-md-3">
                            <p>
                                2019 &copy; All Rights Reserved.
                            </p>
                        </div>
                        <div class="col-md-9">

                            <p>
                                <a href="../../-/media/Files/Privacy_Policy_and_Cookie_Policy_Europe.pdf">Privacy Policy</a> | <a href="../../-/media/Files/Website_TCs_Template.pdf">Terms and Conditions</a>
                            </p>
                        </div>
                    </div>
                </div>
            </div><!--/copyright-->
        </div>

        <div class="hidden" id="perfResults">
            <li class="topbar-devider"></li>
            <li>
                <i class="fa fa-clock-o" title="Page Render Time"></i> 30
            </li>
            <li>
                <img src="content/icon-bbbbbb-16.html" title="Glass Time" style="width: 8px;"> 3
            </li>
            <li>
                <i class="fa fa-pencil-square-o" title="Glass items requested"></i> 13
            </li>
            <li>
                <i class="fa fa-cloud" title="Glass items from cache"></i> 10
            </li>
        </div>
        <script>
            (function ($) {

                $(function () {
                    var results = $("#perfResults");
                    var placeholder = $("#resultsReplaces");

                    var html = results.html();
                    placeholder.replaceWith(html);
                });
            })(jQuery);
        </script>




    </div>
</body>


<!-- Mirrored from glass.lu/blog/archive/How to configure Sitecore 65 to work in NUnit by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 24 May 2021 11:25:37 GMT -->
</html>